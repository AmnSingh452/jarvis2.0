<div id="chatbot-widget"></div>
<script>
  // Force all API calls through CORS proxy - no direct external API calls
  window.SHOPIFY_CHATBOT_CONFIG = {
    shop_domain: "{{ shop.permanent_domain }}",
    shop_name: "{{ shop.name }}",
    shop_id: {{ shop.id }},
    shop_currency: "{{ shop.currency }}",
    shop_timezone: "{{ shop.timezone }}",
    // Updated to use full app proxy URLs - all calls go through your deployed app
    api_endpoints: {
      chat: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/chat",
      recommendations: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/recommendations", 
      abandoned_cart_discount: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/abandoned-cart-discount",
      session: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/session",
      customer_update: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/customer/update",
      widget_config: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/widget-config",
      widget_settings: "https://jarvis2-0-djg1.onrender.com/a/jarvis-proxy/widget-settings"
    },
    // Use app proxy for all API calls (no CORS issues)
    use_proxy: true,
    proxy_base_url: "https://jarvis2-0-djg1.onrender.com" // Use your app's domain for proxy calls
  };
  
  // Set global shop domain for backward compatibility
  window.SHOP_DOMAIN = "{{ shop.permanent_domain }}";
  
  // Shopify object for additional compatibility
  window.Shopify = window.Shopify || {};
  window.Shopify.shop = "{{ shop.permanent_domain }}";
  
  // Debug: Log the configuration for troubleshooting
  console.log('ü§ñ Chatbot Config (FULL PROXY URLs):', window.SHOPIFY_CHATBOT_CONFIG);
  console.log('üè™ Shop Domain:', window.SHOP_DOMAIN);
  console.log('‚úÖ All API calls use full proxy URLs - no CORS errors expected');
</script>
<script src="https://widget-frontend-6mo6.onrender.com/shopify_chatbot_widget.js"></script>
<link rel="stylesheet" href="https://widget-frontend-6mo6.onrender.com/shopify_chatbot_widget.css"> 

